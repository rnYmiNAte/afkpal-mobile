name: Battery Monitor

on:
  workflow_dispatch:
  schedule:
    - cron: '*/15 * * * *'  # Optional: check battery every 15 minutes

jobs:
  monitor:
    runs-on: ubuntu-latest
    

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Monitor Battery
        run: |
          echo "Starting battery monitoring..."
          chmod +x scripts/battery/charging_control.sh
          chmod +x scripts/battery/discharging_control.sh

          # Example: read current battery capacity from JSON
          BATTERY_CAPACITY=$(jq '.capacity' json/battery.json)
          echo "Current Battery Capacity: $BATTERY_CAPACITY mAh"

      - name: Battery Status
        run: |
          # Optional: alert if battery low
          BATTERY_LEVEL=$(jq '.capacity' json/battery.json)
          if [ "$BATTERY_LEVEL" -lt 2000 ]; then
            echo "Warning: Battery is low ($BATTERY_LEVEL mAh)"
          else
            echo "Battery level OK: $BATTERY_LEVEL mAh"
          fi
